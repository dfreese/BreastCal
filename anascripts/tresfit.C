TFile *f0 = new TFile("PT_DAQ_1310091033_all.merged.ana.root")
TTree *m0 = (TTree *) m->Get("mana")
TTree *m0 = (TTree *) m->Get("merged")
TTree *m0 = (TTree *) f0->Get("mana")
m0->Draw("dtf")
TH1F *tres0 = new TH1F("tres","T_{res}",600,-150,150)
m0->Draw("dtf>>tres0")
TH1F *tres0 = new TH1F("tres0","T_{res}",600,-150,150)
m0->Draw("dtf>>tres0")
TFile *f1 = new TFile("PT_DAQ_1310091033_all.merged.ana.apdoffcal.root")
TTree *m1 = (TTree *) f0->Get("mana")
m1->Draw("dtf")
TH1F *tres1 = new TH1F("tres1","T_{res}",600,-150,150)
m1->Draw("dtf>>tres1")
tres0->Draw("same")
TTree *m1 = (TTree *) f1->Get("mana")
m1->Draw("dtf>>tres1")
TTree *m1 = (TTree *) f1->Get("merged")
m1->Draw("dtf>>tres1")
tres0->Draw("same")
TFile *f2 = new TFile("PT_DAQ_1310091033_all.merged.ana.apdoffcal.apdoffcal.root")
TFile *f3 = new TFile("PT_DAQ_1310091033_all.merged.ana.apdoffcal.apdoffcal.crystaloffcal.root")
TFile *f4 = new TFile("PT_DAQ_1310091033_all.merged.ana.apdoffcal.apdoffcal.crystaloffcal.edepcal.root")
TTree *m2 = (TTree *) f2->Get("merged")
TTree *m3 = (TTree *) f3->Get("merged")
TTree *m4 = (TTree *) f4->Get("merged")
.!ls
ls -ltr
.!ls -ltr
TFile *f5 = new TFile("PT_DAQ_1310091033_all.merged.ana.apdoffcal.apdoffcal.crystaloffcal.edepcal.crystaloffcal.root")
TTree *m5 = (TTree *) f5->Get("merged")
TH1F *tres2 = new TH1F("tres2","T_{res}",600,-150,150)
TH1F *tres3 = new TH1F("tres3","T_{res}",600,-150,150)
TH1F *tres4 = new TH1F("tres4","T_{res}",600,-150,150)
TH1F *tres5 = new TH1F("tres5","T_{res}",600,-150,150)
m2->Draw("dtf>>tres2")
m2->Draw();m1->Draw("same")
tres2->Draw();tres1->Draw("same")
m3->Draw("dtf>>tres3")
m4->Draw("dtf>>tres4")
m5->Draw("dtf>>tres5")
fitgaus(tres0)
fitgaus_peak(tres0)
fitgaus_peak(tres0,0)
fitgaus_peak(tres1,0)
fitgaus_peak(tres2,0)
fitgaus_peak(tres3,0)
fitgaus_peak(tres4,0)
fitgaus_peak(tres5,0)
TF1 *f0  =new TF1("f1","gaus")
TF1 *gf0  =new TF1("gf0","gaus")
TF1 *gf1  =new TF1("gf1","gaus")
TF1 *gf2  =new TF1("gf2","gaus")
TF1 *gf3  =new TF1("gf3","gaus")
TF1 *gf4  =new TF1("gf4","gaus")
TF1 *gf5  =new TF1("gf5","gaus")
tres0->Fit("gf0")
tres0->Fit("gf0","","",-75,75)
gf0->SetLineColor(kRed)
tres2->Fit("gf2","","",-75,75)
tres2->Fit("gf2","","",-25,25)
gf2->SetLineColor(kBlue)
tres2->Fit("gf2","","",-20,20)
tres2->Fit("gf2","","",-15,15)
gf3->SetLineColor(kGreen+1)
tres3->Fit("gf3","","",-15,15)
tres3->Fit("gf3","","",-12,12)
gf4->SetLineColor(kCyan)
tres4->Fit("gf4","","",-12,12)
tres4->Fit("gf4","","",-10,10)
gf5->SetLineColor(kMagenta)
tres5->Fit("gf5","","",-10,10)
TF1 *f1 = new TF1("f1","gaus+gaus(3)+gaus(6)+pol0(9)",-150,150)
TF1 *allfit = new TF1("allfit","gaus+gaus(3)+gaus(6)+pol0(9)",-150,150)
Double_t para[10]={80000,0,6.5,1000,-40,15,1000,40,15,2000}
allfit->SetParameters(para)
tres5->Fit("allfit","","",-150,150)
allfit->SetLineColor(kMagenta)
tres5->Fit("allfit","","",-150,150)
tres5->Fit("allfit","","",-150,150)
tres4->Draw();tres3->Draw("same");tres2->Draw("same");tres0->Draw("same")
gf0->SetLineColor(kRed)
tres0->Fit("gf0","","",-75,75)
tres4->Draw();tres3->Draw("same");tres2->Draw("same");tres0->Draw("same")
TLegend *leg = new TLegend(.6,.6,.8,.8)
leg->AddEntry(gf0,"Uncalibrated Timing T_{res}^{FWHM} = 108.6 ns","l")
leg->AddEntry(gf1,"Correct APD offset T_{res}^{FWHM} = 28.0 ns","l")
TLegend *leg = new TLegend(.6,.6,.8,.8)
leg->AddEntry(gf0,"Uncalibrated Timing T_{res}^{FWHM} = 108.6 ns","l")
leg->AddEntry(gf2,"Correct APD offset T_{res}^{FWHM} = 28.0 ns","l")
leg->AddEntry(gf3,"Correct crystal offset T_{res}^{FWHM} = 19.7 ns","l")
leg->AddEntry(gf4,"Correct energy dependence T_{res}^{FWHM} = 15.7 ns","l")
leg->Draw()
leg->SetFillColor(kWhite);
gStyle->SetOptDate();
gStyle->SetOptDate(0);
tres4->SetXTitle("#Delta t (ns)")
tres4->Draw();tres3->Draw("same");tres2->Draw("same");tres0->Draw("same")
leg->Draw()
c1->Print("timingcalibration.eps")
c1->Print("timingcalibration.png")
c1->Print("timingcalibration.C")
gf5->Draw()
tres5->Draw()
tres5->Fit("allfit","","",-100,100)
tres5->Fit("allfit","","",-50,100)
tres5->Fit("allfit","","",-150,100)
tres5->Fit("allfit","","",-150,150)
c1->Print("tres_calib.eps")
c1->Print("tres_calib.png")
c1->Print("tres_calib.C")
.q!
